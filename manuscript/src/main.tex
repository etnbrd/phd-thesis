%!TEX TS-program = xelatex
%!TEX encoding = UTF-8 Unicode
\documentclass[12pt]{report}

\newlength{\alphabet}
\settowidth{\alphabet}{\normalfont abcdefghijklmnopqrstuvwxyz}

\usepackage[top=15mm, bottom=15mm, textwidth=2.4\alphabet, hmarginratio={1:1}]{geometry}

\usepackage[french, english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{fontspec}
\usepackage{xunicode}
\PassOptionsToPackage{hyphens}{url}
\usepackage[hidelinks=true]{hyperref}
\usepackage{tabu}

\input{bibliography}
\input{utils/code}
\input{utils/macros}
\input{utils/fonts}
\input{utils/titlesec}
% \input{utils/toc}
\input{utils/tables}

\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{multirow}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{wrapfig}
\usepackage{floatflt}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{longtable}
\usepackage{amsmath}
\usepackage{backnaur}
\usepackage[normalem]{ulem}
\usepackage{import}
\usepackage{lscape}
\usepackage{rotating}
\usepackage{xparse}
\usepackage[group-separator={,}]{siunitx}
\usepackage{eso-pic}
\usepackage{framed}
\usepackage{pdfpages}
\usepackage{caption}
\usepackage{fancyhdr}
% \usepackage{minitoc}
% \nomtcrule
% \usepackage{titletoc}

\usepackage{tocloft}
\usepackage{etoc}


% \usepackage{etoolbox}

% \makeatletter
% \patchcmd{\l@chapter}
%   {\cftchapfont #1}%   search pattern
%   {\cftchapfont {#1}}% replace by
%   {}%                  success
%   {}%                  failure
% \makeatother


% \etocmulticolstyle{\noindent\bfseries\footnotesize
% \leaders\hrule height1pt\hfill
% \MakeUppercase{Contents}}
% \etocsettocstyle{\bigskip\hrule\medskip}{\medskip\hrule\vfill}


\defaultfontfeatures{Ligatures=TeX}

\usepackage[all]{nowidow}
\usepackage{needspace}

\clubpenalty=9996
\widowpenalty=9999
\brokenpenalty=4991
\predisplaypenalty=10000
\postdisplaypenalty=1549
\displaywidowpenalty=1602

\usepgfplotslibrary{external} 
\tikzexternalize[prefix=figures/]
\tabulinestyle{.2pt}
\tabulinesep=2mm

\setcounter{secnumdepth}{2}
\setcounter{tocdepth}{2}
% \setcounter{minitocdepth}{2}

\pagestyle{empty}

\begin{document}

\defaultfontfeatures{Ligatures=TeX}

% \includepdf{front.pdf} \blank%
\input{front} \blank%
\input{ecole-doctorales} \blank%

\input{00-abstract/main}

% iconfont\\
% \foreach \x in {0,...,646}
%    {\x\thinspace\iconfont{\XeTeXglyph\x} }\\
% typicons\\
% \foreach \x in {0,...,336}
%    {\x\thinspace\typicons{\XeTeXglyph\x} }\\
% elusive\\
% \foreach \x in {0,...,300}
%    {\x\thinspace\elusive{\XeTeXglyph\x} }\\
% linecons\\
% \foreach \x in {0,...,50}
%    {\x\thinspace\linecons{\XeTeXglyph\x} }\\
% \eject

\input{acknowledgement}

% \dominitoc%
% \etocsettocstyle{Content}{}%

% \renewcommand{\cfttoctitlefont}{\normalfont\Large\bfseries\MakeUppercase}
% \renewcommand{\contentsname}{Contents}
% \renewcommand{\cftchapfont}{\secfont\fontsize{17pt}{17pt}\selectfont\MakeUppercase}
% \renewcommand{\cftchapfont}{\secfont\fontsize{20pt}{20pt}\selectfont}

\tableofcontents\newpage%\eject
\listoffigures\newpage%\eject
\listoftables\newpage%\eject
\listofillustration%

\etocsettocstyle{}{}%
\cftsecindent 0pt
% \cftsubsecindent 25pt
\pagestyle{fancy}

\input{01-introduction/main}
\input{02-context/main}
\input{03-state-of-the-art/main}
\input{04-proposition/main}
\input{05-implementation/main}
\input{90-conclusion/main}

\eject
\renewcommand{\glyph}{\linecons{\XeTeXglyph39}}
\printbibliography[]

\input{91-appendix/main}

\newpage
\pagestyle{empty}
\input{folio}

\end{document}