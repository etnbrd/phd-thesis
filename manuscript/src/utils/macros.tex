\usepackage{marginnote}
\usepackage{xcolor}
\usepackage{pifont}
\usepackage{calc}

\definecolor{todo}{rgb}{0.9,0.5,0.5}
\definecolor{text}{gray}{0.8}
\definecolor{gray1}{rgb}{.70,.70,.70}
\definecolor{gray2}{rgb}{.75,.75,.75}
\definecolor{gray3}{rgb}{.80,.80,.80}
\definecolor{gray4}{rgb}{.85,.85,.85}
\definecolor{gray5}{rgb}{.90,.90,.90}
\definecolor{gray6}{rgb}{.95,.95,.95}

\definecolor{LIGTHGRAY}{RGB}{250,250,250}

\definecolor{RED}{RGB}{255, 0, 73}
\definecolor{GREEN}{RGB}{0, 224, 197}
\definecolor{BLUE}{RGB}{57, 117, 178}

\newlength{\figurewidth}
\setlength\figurewidth{\paperwidth}

\newlength{\figuremargin}
\setlength\figuremargin{(\linewidth-\figurewidth)/2}

\newcommand{\ind }{%
  \hspace{4ex}%
}

\newcommand{\comment}[1]{%
  \textcolor{text}{#1}%
}

\newcommand{\nt}[1]{%
  \textcolor{red}{*}%
  \marginpar{\textcolor{red}{\fontencoding{U}\fontfamily{futs}\selectfont\char 66\relax}\vspace{3mm}\\
  \tiny{\textcolor{text}{#1}}}%
}

\newcommand{\illustration}[1]{%
% \reversemarginpar%
% \marginpar{\tiny{illustration:\\#1}}%
% \normalmarginpar%
}

\newcommand{\ftnt}[1]{%
  \footnote{\small{\url{#1}}}%
}

\newcommand{\cit}[2]{%
  \vskip \baselineskip%
  \textit{%
    \llap{\hfill\secfont\fontsize{45pt}{45pt}\selectfont\textcolor{red}{{`}`}\hspace{15pt}}%
    \vskip -2.2\baselineskip%
    \noindent\Large{#1}{\textcolor{red}{''}}%
  }%
  \begin{flushright}%
  --- #2%
  \end{flushright}%
  \vskip 30pt%
}


% \newenvironment{atomic}{%
% \begin{minipage}{\linewidth}%
% }{%
% \end{minipage}%
% }

\newcommand{\atomic}[1]{%
  \parbox{\textwidth}{#1}%
}

\newcommand{\bigfig}[1]{%
  \fboxsep 20pt%
  \makebox[\textwidth][c]{\colorbox{LIGTHGRAY}{\parbox{\figurewidth}{#1}}}%
}

\newcommand{\textfig}[1]{%
  \fboxsep 0pt%
  \makebox[\textwidth][c]{\colorbox{LIGTHGRAY}{\parbox{\textwidth}{\vspace{20pt}\centering#1\vspace{20pt}}}}%
}


\newcommand{\marginfig}[3]{%
  \fboxsep 20pt
  \begin{wrapfigure}[#1]{R}[0.25\textwidth]{0pt}%
    \makebox[#2]{\hfill\vspace{-2000pt}\colorbox{LIGTHGRAY}{#3}\hspace{20pt}}%
  \end{wrapfigure}%
}

\newcommand{\dualfig}[3]{%
  \bigfig{%
    \parbox{0.5\figurewidth-10pt}{\hfill #1}%
    \hskip 10pt \vrule \hskip 10pt%
    \parbox{0.5\figurewidth-10pt}{#2 \hfill}%
    #3
  }
}



\newcommand*\rot{\rotatebox{90}}

\newcommand\lab[1]{%
  \rotatebox{90}{\parbox{3cm}{\raggedright #1}}%
}

\newcommand{\separator}{%
  \par% make sure we end a paragraph
  \vskip 15pt% space above the rule
  % \leaders\vrule width 0.2\textwidth\vskip0.4pt % rule thickness is 0.4pt
  \begin{center}%
  \begin{tikzpicture}%
  \draw (0,0) -- (0.2,0.2);%
  \draw (0,0.2) -- (0.2,0);%
  \end{tikzpicture}%
  \end{center}%
  % \nointerlineskip% disable interline glue here
  % \vskip 20pt% space below the rule
}

% \newlength\callStackIndentation
% \newcommand{\level}[1]{%
%   \setlength\callStackIndentation{2em}%
%   \hspace*{#1\callStackIndentation}%
% }

\newcommand*{\circled}[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=0.8pt] (char) {#1};}}

\newcommand*{\dotcircled}[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,line cap=round, dash pattern=on 0pt off 3pt,inner sep=0.8pt] (char) {#1};}}

\newcommand*{\rate}[1]{\tikz[baseline=(char.base)]{%
            \ifnum#1=6 ?%
            \colorlet{tmpcolor}{BLUE}%
            \else%
            \colorlet{tmpcolor}{GREEN!\the\numexpr#1*20!RED}%
            \fi%
            \node[shape=circle,inner sep=0.8pt, fill=tmpcolor] (char) {\textcolor{white}{\ifnum#1=6\textbf?\else\textbf#1\fi}};}}